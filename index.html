<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Translator Tsunagu For You | æ–‡è„ˆã«å¼·ã„AIç¿»è¨³ãƒ»èªå­¦å­¦ç¿’ã‚¢ãƒ—ãƒª</title>
  <meta name="description" content="A translation app designed for language learning, featuring natural translations that adapt to context and situation, along with detailed explanations in your native language. Unlike typical AI translators, it's optimized for language acquisition and cross-cultural understanding. ">
  <link rel="icon" href="./favicon.png" type="image/png">
  <!-- âœ… OGP Tags -->
  <meta property="og:title" content="Translator Tsunagu For You | æ–‡è„ˆã«å¼·ã„AIç¿»è¨³ã‚¢ãƒ—ãƒª">
  <meta property="og:description" content="æ–‡è„ˆã«å¿œã˜ãŸè‡ªç„¶ãªç¿»è¨³ã¨ã€æ¯èªã«ã‚ˆã‚‹ä¸å¯§ãªè§£èª¬ã§ã€èªå­¦å­¦ç¿’ã‚’å¼·åŠ›ã«ã‚µãƒãƒ¼ãƒˆã€‚Google Geminiæ´»ç”¨ã€‚">
  <meta property="og:image" content="https://koyasi777.github.io/Translator-Tsunagu-For-You/ogp-image.png">
  <meta property="og:url" content="https://koyasi777.github.io/Translator-Tsunagu-For-You/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Translator Tsunagu For You">
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#3069a6">
  <!-- Twitter Cardï¼ˆä»»æ„ï¼‰ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Translator Tsunagu For You">
  <meta name="twitter:description" content="æ–‡è„ˆã«å¼·ã„AIç¿»è¨³ï¼†èªå­¦å­¦ç¿’æ”¯æ´ã‚¢ãƒ—ãƒª">
  <meta name="twitter:image" content="https://koyasi777.github.io/Translator-Tsunagu-For-You/ogp-image.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    .app-container { max-width: 960px; margin: auto; background: #fff; padding: 2rem; border-radius: 1rem; box-shadow: 0 0 20px rgba(0,0,0,0.05); }
    .lang-label { font-weight: bold; font-size: 0.9rem; color: #495057; margin-bottom: 0.5rem; }
    .hyphen-code { letter-spacing: 0.3em; font-family: monospace; }
    .lang-select-group { display: flex; align-items: center; gap: 1rem; flex-wrap: nowrap; white-space: nowrap; }
    .lang-select {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      white-space: nowrap;
    }
    .lang-select label {
      white-space: nowrap;
    }
    .lang-select i {
      font-size: 1rem;
      color: #6c757d;
    }
    @media (max-width: 991.98px) {
      .lang-select-group {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
      }
    }
    .offcanvas-body .section-title {
      font-weight: 600;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
    }
    .offcanvas-body .btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .translation-wrapper {
      position: relative;
      padding-bottom: 1.5rem; /* Copyãƒœã‚¿ãƒ³åˆ†ã®ã‚¹ãƒšãƒ¼ã‚¹ */
    }
    .copy-btn {
      position: absolute;
      bottom: 0.5rem;
      right: 0.5rem;
      z-index: 10;
    }
  </style>
  <!-- âœ… æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆJSON-LDï¼‰ -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Translator Tsunagu For You",
      "url": "https://koyasi777.github.io/Translator-Tsunagu-For-You/",
      "applicationCategory": "TranslationApplication",
      "operatingSystem": "All",
      "description": "æ–‡è„ˆã«å¿œã˜ãŸè‡ªç„¶ãªç¿»è¨³ã¨æ¯èªã«ã‚ˆã‚‹è§£èª¬ã§ã€èªå­¦å­¦ç¿’ã‚’æ”¯æ´ã™ã‚‹AIç¿»è¨³ã‚¢ãƒ—ãƒªã§ã™ã€‚",
      "browserRequirements": "Requires JavaScript and a modern browser",
      "image": "https://koyasi777.github.io/Translator-Tsunagu-For-You/ogp-image.png"
    }
    </script>
</head>
<body class="bg-light">
  <h1 class="visually-hidden">Translator Tsunagu For You - æ–‡è„ˆã«å¼·ã„AIç¿»è¨³ãƒ»èªå­¦å­¦ç¿’æ”¯æ´ã‚¢ãƒ—ãƒª</h1>
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <i class="bi bi-translate fs-3 me-2"></i><span class="h5 mb-0">Translator Tsunagu For You</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse d-none d-lg-flex">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item me-3">
            <div class="lang-select-group">
              <div class="lang-select">
                <label for="navMotherLang" class="form-label mb-0 me-1">ğŸ‘¤ æ¯èª</label>
                <select id="navMotherLang" class="form-select form-select-sm"></select>
              </div>
              <span class="lang-separator">/</span>
              <div class="lang-select">
                <label for="navLearnLang" class="form-label mb-0 me-1">ğŸ“ å­¦ç¿’è¨€èª</label>
                <select id="navLearnLang" class="form-select form-select-sm">
                </select>
              </div>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
              <i class="bi bi-list fs-5"></i>
            </a>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#apiKeyModal">ğŸ”‘ APIã‚­ãƒ¼è¨­å®š</a></li>
              <li>
                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#modelSettingModal">
                  ğŸ› ï¸ ãƒ¢ãƒ‡ãƒ«è¨­å®š
                </a>
              </li>
              <li><a class="dropdown-item" href="#" data-bs-toggle="offcanvas" data-bs-target="#bookmarkSidebar">ğŸ“š ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Offcanvas Mobile Menu -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="mobileMenu">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <button class="btn btn-outline-secondary w-100 mb-2" data-bs-toggle="modal" data-bs-target="#mobileLangModal">
        <i class="bi bi-gear"></i> è¨€èªè¨­å®š
      </button>
      <button class="btn btn-outline-secondary w-100 mb-2" data-bs-toggle="modal" data-bs-target="#apiKeyModal">
        <i class="bi bi-key"></i> APIã‚­ãƒ¼è¨­å®š
      </button>
      <button class="btn btn-outline-secondary w-100 mb-2" data-bs-toggle="modal" data-bs-target="#modelSettingModal">
        <i class="bi bi-cpu"></i> ãƒ¢ãƒ‡ãƒ«è¨­å®š
      </button>
      <button class="btn btn-outline-primary w-100 mb-2" data-bs-toggle="offcanvas" data-bs-target="#bookmarkSidebar">
        <i class="bi bi-bookmarks"></i> ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
      </button>
    </div>
  </div>

  <div class="app-container">
    <div class="row g-4">
      <div class="col-md-6">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="lang-label d-flex align-items-center mb-0" id="srcInfo">ç¿»è¨³å…ƒ</div>
          <!-- ãƒ¢ãƒã‚¤ãƒ«ç”¨ Language Settings ãƒœã‚¿ãƒ³ -->
          <button id="mobileLangBtn"
                  class="btn btn-outline-secondary btn-sm d-lg-none"
                  data-bs-toggle="modal"
                  data-bs-target="#mobileLangModal">
            <i class="bi bi-gear"></i> Language Settings
          </button>
        </div>
        <textarea id="inputText" class="form-control mb-2" rows="6" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›â€¦"></textarea>
        <div class="mt-2 mb-2">
          <button id="toggleContextBtn" class="btn btn-secondary btn-sm w-100">
            <i class="bi bi-plus-lg me-1"></i>æ–‡è„ˆã‚’è¿½åŠ 
          </button>
        </div>
        <div id="contextContainer" class="mb-3 d-none">
          <textarea id="contextText" class="form-control" rows="2" placeholder="çŠ¶æ³ã‚„ã‚·ãƒ¼ãƒ³ãªã©ã®æ–‡è„ˆã‚’å…¥åŠ›â€¦"></textarea>
        </div>
        <div class="d-grid gap-2 d-md-flex">
          <button id="translateBtn" class="btn btn-primary me-2 w-100 w-md-auto">ç¿»è¨³ã™ã‚‹</button>
          <button id="saveBtn" class="btn btn-success w-100 w-md-auto" disabled>ğŸ”– ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</button>
        </div>
      </div>
      <div class="col-md-6">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="lang-label mb-0" id="tgtInfo">ç¿»è¨³å…ˆ</div>
          <div class="form-check form-switch d-flex align-items-center mb-0">
            <input class="form-check-input" type="checkbox" id="explainModeToggle" checked>
            <label class="form-check-label ms-2 mb-0" for="explainModeToggle">è§£èª¬ãƒ¢ãƒ¼ãƒ‰</label>
          </div>
        </div>
        <div id="result">
          <div id="translationSection" class="border bg-white p-3 mb-3">
            <div class="text-muted text-center py-5">ç¿»è¨³çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
            <button id="copyTranslationBtn" class="btn btn-outline-primary btn-sm mt-2" style="display:none;">Copy</button>
          </div>
          <div id="explanationSection" class="border bg-white p-3" style="min-height:240px; display: none;">
            <div class="text-muted text-center py-5">è§£èª¬ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚µã‚¤ãƒ‰ãƒãƒ¼å…¨ä½“ -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="bookmarkSidebar">
    <div class="offcanvas-header d-flex justify-content-between align-items-center">
      <h5 class="offcanvas-title mb-0 d-flex align-items-center">
        ğŸ“š ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
      </h5>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-outline-warning btn-sm" data-bs-toggle="modal" data-bs-target="#dataMgmtModal">
          <i class="bi bi-gear"></i>
        </button>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
    </div>
    <div class="offcanvas-body" id="bookmarkList">
      <!-- ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯å†…å®¹ãŒã“ã“ã«å‡ºã‚‹ -->
    </div>
  </div>


  <div class="modal fade" id="apiKeyModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">APIã‚­ãƒ¼è¨­å®š</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p>
          ã“ã®ç¿»è¨³ã‚¢ãƒ—ãƒªã¯<br><strong>Googleã®Gemini APIã‚­ãƒ¼ã®è¨­å®šãŒå¿…è¦ã§ã™ï¼ˆç„¡æ–™ï¼‰</strong>
        </p>
        <p>
          <i class="bi bi-info-circle-fill text-info me-1"></i>
          <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studioã®å…¬å¼ãƒšãƒ¼ã‚¸</a>
          ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€<br>å–å¾—ã—ãŸAPIã‚­ãƒ¼ã‚’ä¸‹ã®å…¥åŠ›æ¬„ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚
        </p>
        <p></p>
        <label class="form-label">ğŸ”‘ Gemini APIã‚­ãƒ¼</label>
        <input id="envApiKey" type="text" class="form-control" placeholder="APIã‚­ãƒ¼ã‚’å…¥åŠ›">
        <div id="apiKeyError" class="text-danger mt-2" style="display:none;"></div>
      </div>
      <div class="modal-footer">
        <button id="apiKeySaveBtn" type="button" class="btn btn-primary">ä¿å­˜</button>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="mobileLangModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">è¨€èªè¨­å®š</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="modalMotherLang" class="form-label d-flex align-items-center">
              ğŸ‘¤ æ¯èª
            </label>
            <select id="modalMotherLang" class="form-select">
            </select>
          </div>

          <div class="mb-3">
            <label for="modalLearnLang" class="form-label d-flex align-items-center">
              ğŸ“ å­¦ç¿’è¨€èª
            </label>
            <select id="modalLearnLang" class="form-select">
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="saveLangBtn" type="button" class="btn btn-primary">ä¿å­˜</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modelSettingModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ãƒ¢ãƒ‡ãƒ«è¨­å®š</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <label for="modelSelect" class="form-label">ä½¿ç”¨ã™ã‚‹Geminiãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠ:</label>
        <select id="modelSelect" class="form-select">
          <!-- JSã§å‹•çš„ã«åŸ‹ã‚ã‚‹ -->
        </select>
      </div>
      <div class="modal-footer">
        <button id="saveModelBtn" type="button" class="btn btn-primary">ä¿å­˜</button>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="dataMgmtModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <button id="exportJsonBtn" class="btn btn-outline-success w-100 mb-2">JSONã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        <div class="mb-2">
          <label for="importJsonFile" class="form-label">JSONã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</label>
          <input type="file" id="importJsonFile" class="form-control">
        </div>
        <button id="importJsonBtn" class="btn btn-outline-danger w-100">ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ</button>
      </div>
    </div></div>
  </div>

  <!-- ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal fade" id="bookmarkDetailModal" tabindex="-1">
    <div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ğŸ“˜ ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯è©³ç´°</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p><strong>åŸæ–‡:</strong></p>
        <div id="modalOriginalText" class="border p-2 bg-light"></div>
        <hr>
        <p><strong>è¨³æ–‡:</strong></p>
        <div id="modalTranslatedText" class="border p-2 bg-white"></div>
        <hr>
        <p><strong>æ–‡è„ˆ:</strong></p>
        <div id="modalContextText" class="border p-2 bg-white"></div>
        <hr>
        <p><strong>è§£èª¬ã‚»ã‚¯ã‚·ãƒ§ãƒ³:</strong></p>
        <div id="modalExplanationText" class="border p-2 bg-white"></div>
      </div>
    </div></div>
  </div>

  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1055">
    <div id="bookmarkToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          ğŸ“š ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã«è¿½åŠ ã—ã¾ã—ãŸï¼
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module" src="./app.js"></script>
  <!-- PWA: Service Worker ç™»éŒ² -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js')
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.error('SW registration failed:', err));
      });
    }
  </script>
</body>
</html>
